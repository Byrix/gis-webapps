---
import MainLayout from "../layouts/MainLayout.astro";
import "cesium/Build/Cesium/Widgets/widgets.css";
import { CesiumMap } from "../components/cesium";
import CesiumSkeleton from '../components/cesium/CesiumSkeleton.astro';
import { filterGeojson } from '../utils';

import { getEntry } from 'astro:content';
const [trailData, waypointData] = await Promise.all([
  getEntry('dataSources', 'trail'),
  getEntry('dataSources', 'waypoints').then((raw) => filterGeojson(raw.data, 'marker-color'))
]);
---

<MainLayout title="CesiumJS App">
    <CesiumMap 
      client:only='react' 
      trail={trailData.data}
      waypoints={waypointData}
    >
      <CesiumSkeleton slot='fallback' />
    </CesiumMap>
</MainLayout>
